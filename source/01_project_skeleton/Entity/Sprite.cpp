//
//  Sprite.cpp
//  opengl-series
//
//  Created by SATAN_Z on 16/6/26.
//
//

#include "Sprite.hpp"
#include <stdlib.h>

using namespace ze;

Sprite::Sprite():
_vao(nullptr),
_vertexData(nullptr),
_colorData(nullptr){
    
}

Sprite::~Sprite(){
    
}

bool Sprite::initTexture(){
    Bitmap bitmap = Bitmap::loadFromFile("wooden-crate.jpg");
    _texture.init(bitmap);
}

bool Sprite::initVao(){
    // Make a cube out of triangles (two triangles per side)
    GLfloat vertexData[] = {
        //  X     Y     Z       U     V
        // bottom
        -1.0f,-1.0f,-1.0f,   0.0f, 0.0f,
        1.0f,-1.0f,-1.0f,   1.0f, 0.0f,
        -1.0f,-1.0f, 1.0f,   0.0f, 1.0f,
        1.0f,-1.0f,-1.0f,   1.0f, 0.0f,
        1.0f,-1.0f, 1.0f,   1.0f, 1.0f,
        -1.0f,-1.0f, 1.0f,   0.0f, 1.0f,
        
        // top
        -1.0f, 1.0f,-1.0f,   0.0f, 0.0f,
        -1.0f, 1.0f, 1.0f,   0.0f, 1.0f,
        1.0f, 1.0f,-1.0f,   1.0f, 0.0f,
        1.0f, 1.0f,-1.0f,   1.0f, 0.0f,
        -1.0f, 1.0f, 1.0f,   0.0f, 1.0f,
        1.0f, 1.0f, 1.0f,   1.0f, 1.0f,
        
        // front
        -1.0f,-1.0f, 1.0f,   0.0f, 1.0f,
        1.0f,-1.0f, 1.0f,   1.0f, 1.0f,
        -1.0f, 1.0f, 1.0f,   0.0f, 0.0f,
        1.0f,-1.0f, 1.0f,   1.0f, 1.0f,
        1.0f, 1.0f, 1.0f,   1.0f, 0.0f,
        -1.0f, 1.0f, 1.0f,   0.0f, 0.0f,
        
        // back
        -1.0f,-1.0f,-1.0f,   0.0f, 0.0f,
        -1.0f, 1.0f,-1.0f,   0.0f, 1.0f,
        1.0f,-1.0f,-1.0f,   1.0f, 0.0f,
        1.0f,-1.0f,-1.0f,   1.0f, 0.0f,
        -1.0f, 1.0f,-1.0f,   0.0f, 1.0f,
        1.0f, 1.0f,-1.0f,   1.0f, 1.0f,
        
        // left
        -1.0f,-1.0f, 1.0f,   0.0f, 1.0f,
        -1.0f, 1.0f,-1.0f,   1.0f, 0.0f,
        -1.0f,-1.0f,-1.0f,   0.0f, 0.0f,
        -1.0f,-1.0f, 1.0f,   0.0f, 1.0f,
        -1.0f, 1.0f, 1.0f,   1.0f, 1.0f,
        -1.0f, 1.0f,-1.0f,   1.0f, 0.0f,
        
        // right
        1.0f,-1.0f, 1.0f,   1.0f, 1.0f,
        1.0f,-1.0f,-1.0f,   1.0f, 0.0f,
        1.0f, 1.0f,-1.0f,   0.0f, 0.0f,
        1.0f,-1.0f, 1.0f,   1.0f, 1.0f,
        1.0f, 1.0f,-1.0f,   0.0f, 0.0f,
        1.0f, 1.0f, 1.0f,   0.0f, 1.0f
    };
    GLint size = sizeof(vertexData) * sizeof(GLfloat);
    _vertexData = (GLfloat *)malloc(size);
    memcpy(_vertexData , vertexData , size);
    
    
    zdogl::Buffer vbo;
    vbo.setBufferType(GL_ARRAY_BUFFER);
    vbo.inflateBuffer(size , _vertexData , GL_STATIC_DRAW);
    
    _vao = new zdogl::VertexArray();
    _vao->addBuffer(vbo);
    
    
}

bool Sprite::init(){
    initTexture();
    
    initVao();
    
    return true;
}


void Sprite::draw(){
    
  // todo
    
}






















